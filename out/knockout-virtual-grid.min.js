define("text!src/knockout-virtual-grid.html",[],function(){return'<table class="vg-t" data-bind="css: tableCss">\n    <thead></thead>\n    <tbody>\n        <!-- ko foreach: virtualGridRow -->\n        <tr class="vg-r" data-bind="css: rowCss">\n            <!-- ko foreach: $data.fixedColumns -->\n            <td class="vg-c vg-f" data-bind="css: css, html: value"></td>\n            <!-- /ko -->\n\n            <!-- ko if: $data.editable -->\n            <!-- ko foreach: $data.columns -->\n            <td class="vg-c" data-bind="css: css, editableCell: value, cellHTML: $parent.format(value()), cellReadOnlly: readonly"></td>\n            <!-- /ko -->\n            <!-- /ko -->\n            <!-- ko ifnot: $data.editable -->\n            <!-- ko foreach: $data.columns -->\n            <td class="vg-c" data-bind="css: css, html: $parent.format(value())"></td>\n            <!-- /ko -->\n            <!-- /ko -->\n        </tr>\n        <!-- /ko -->\n    </tbody>\n    <tfoot>\n    </tfoot>\n</table>\n'}),define("src/knockout-virtual-grid",["require","exports","knockout","text!./knockout-virtual-grid.html"],function(o,t,s){t.template=o("text!./knockout-virtual-grid.html");var n=function(){function o(o){var t=this;if(console.log("[KnockoutVirtualGrid] %o",o),!o||!o.dataSource)throw new Error("Invalid params");this.tableCss=s.observable(o.css||""),this.dataSource=o.dataSource;var n=o.dataSource(),a=this.measure(n);this.layout=new e(a.maxRows,a.maxColumns,o.offset,o.layout);var r=this.initialize(n);this.virtualGridRow=s.observableArray([]).extend({rateLimit:0}),this.virtualGridRow(r),this.render(),this.subscriptions=[this.layout.changed.subscribe(function(){return t.render()}),this.dataSource.subscribe(function(){return t.render()})]}return o.prototype.onNewData=function(o){var t=this.measure(o);t.maxRows<this.layout.rows()||t.maxColumns<this.layout.columns()?(console.log("[VG] re-initializing"),this.layout.maxRows=t.maxRows,this.layout.maxColumns=t.maxColumns,this.render()):(this.layout.maxRows=t.maxRows,this.layout.maxColumns=t.maxColumns,this.render())},o.prototype.measure=function(o){var t={maxRows:0,maxColumns:0};return o&&o.length>0&&(t.maxRows=o.length,o[0].columns&&o[0].columns.length>0&&(t.maxColumns=o[0].columns.length)),console.log("[VG] initialize: %o",t),t},o.prototype.initialize=function(o){if(!o||0===o.length)return[];var t,n,e,a=[],r=Math.min(o.length,this.layout.rows()),i=Math.min(o[0].columns.length,this.layout.columns()),l=Math.min(this.layout.column(),r),u=Math.min(this.layout.row(),i);console.log("[VG] convert: max rows: %d, max cols: %d, i: %d, j: %d",r,i,l,u);for(var c=l;r>c;c++){t=o[c],e=[];for(var m=u;i>m;m++)n=t.columns[m],e.push({columnIndex:m,rowIndex:c,value:s.observable(n.value),css:s.observable(n.css&&n.css.length>0?n.css.join(" "):""),readonly:s.observable(!1),metadata:{}});a.push({rowIndex:c,columns:s.observableArray(e),rowCss:s.observable(t.css&&t.css.length>0?t.css.join(" "):""),fixedColumns:s.observableArray([]),format:function(o){return o.toString()},editable:s.observable(!0)})}return console.log("[VG] convert - rows: %d",a.length),a},o.prototype.render=function(){var o=this.dataSource(),t=this.virtualGridRow();if(o&&0!==o.length){var s={row:this.layout.row(),column:this.layout.column()},n={row:Math.min(s.row,this.layout.maxRows-this.layout.rows()),column:Math.min(s.column,this.layout.maxColumns-this.layout.columns())},e={row:Math.min(n.row+this.layout.rows(),this.layout.maxRows),column:Math.min(n.column+this.layout.columns(),this.layout.maxColumns)};console.log("[VG] render: source: [%d, %d ], start: %o, end: %o",o.length,o[0].columns.length,n,e);for(var a=0,r=n.row;r<e.row;r++,a++){var i=o[r],l=t[a],u=l.columns();l.rowCss(i.css&&i.css.length>0?i.css.join(" "):"");for(var c=0,m=n.column;m<e.column;m++,c++){var h=i.columns[m],d=u[c];d.value(h.value),d.css(h.css&&h.css.length>0?h.css.join(" "):"")}}}},o.prototype.dispose=function(){for(var o=0;o<this.subscriptions.length;o++){var t=this.subscriptions[o];t&&t.dispose&&t.dispose()}this.layout.dispose()},o}();t.viewModel=n;var e=function(){function o(o,t,n,e){var a=this;this.maxRows=o,this.maxColumns=t;var r,i=[];i.push(n&&n.row?n.row:s.observable(0)),i.push(n&&n.column?n.column:s.observable(0)),e&&e.rows?i.push(e.rows):(r=Math.min(25,this.maxRows),i.push(s.observable(r))),e&&e.columns?i.push(e.columns):(r=Math.min(35,this.maxColumns),i.push(s.observable(r))),this.row=s.computed({read:function(){var o=i[0],t=o();return console.log("[VG] layout - row: %d",t),t},write:function(o){var t=a.maxRows-a.rows();i[0](0>o||isNaN(o)?0:o>=0&&t+1>o?o:t)},deferEvaluation:!0,owner:this}).extend({rateLimit:0}),this.column=s.computed({read:function(){return i[1]()},write:function(o){var t=a.maxColumns-a.columns();i[1](0>o||isNaN(o)?0:o>=0&&t+1>o?o:t)},deferEvaluation:!0,owner:this}).extend({rateLimit:0}),this.rows=s.computed({read:function(){return i[2]()},deferEvaluation:!0,owner:this}).extend({rateLimit:0}),this.columns=s.computed({read:function(){return i[3]()},deferEvaluation:!0,owner:this}).extend({rateLimit:0}),this.changed=s.computed({read:function(){return[a.row(),a.column(),a.rows(),a.columns()]},owner:this,pure:!0,deferEvaluation:!0}).extend({rateLimit:0})}return o.prototype.dispose=function(){this.row.dispose(),this.column.dispose(),this.rows.dispose(),this.columns.dispose(),this.changed.dispose()},o}();t.LayoutOffsetHelper=e});